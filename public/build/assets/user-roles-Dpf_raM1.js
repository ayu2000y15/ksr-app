import{r as a,u as U,a as n,j as s,H as w}from"./app-DKRyNxm0.js";import{T as H}from"./toast-DqCeM660.js";import{H as E}from"./heading-BX_Jp4Kc.js";import{B as R}from"./app-logo-icon-CehQoGfx.js";import{C as T,a as _,b as $,c as L}from"./card-CXCGl3qJ.js";import{C as A}from"./checkbox-B0wH8ygF.js";import{L as B}from"./label-CVrHGdFQ.js";import{A as P}from"./app-sidebar-layout-Duv2q2dp.js";/* empty css            */import"./index-C5wNPedj.js";import"./index-C0UCeXqT.js";const F=[{title:"各種設定",href:"#"},{title:"ユーザーへのロール割り当て",href:route("admin.user-roles")}];function W(){const[o,j]=a.useState([]),[g,b]=a.useState([]),[r,N]=a.useState(null),[i,l]=a.useState({}),[m,u]=a.useState(!1),[d,p]=a.useState(null),v=U(),{permissions:h}=v.props,C=h?.user?.update||h?.is_system_admin;a.useEffect(()=>{x(),y()},[]);const x=async()=>{const e=await n.get("/api/users");j(e.data)},y=async()=>{const e=await n.get("/api/roles");b(e.data)},S=e=>{const t=o.find(c=>c.id===e)||null;N(t);const f={};(t?.roles||[]).forEach(c=>{f[c.id]=!0}),l(f)},k=async()=>{if(!r)return;u(!0);const e=Object.keys(i).filter(t=>i[Number(t)]).map(Number);await n.post(`/api/users/${r.id}/roles`,{role_ids:e}),await x(),u(!1),p({message:"保存しました",type:"success"})};return s.jsxs(P,{breadcrumbs:F,children:[s.jsx(w,{title:"ユーザーへのロール割り当て"}),s.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[s.jsx("div",{className:"mb-6",children:s.jsx(E,{title:"ユーザーへのロール割り当て",description:"各ユーザーにどの役割を持たせるかを設定する。"})}),s.jsxs(T,{children:[s.jsx(_,{children:s.jsx($,{children:"ユーザーとロールの関連付け"})}),s.jsx(L,{children:s.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[s.jsxs("div",{className:"rounded-md border",children:[s.jsx("div",{className:"border-b p-2 font-semibold",children:"ユーザー"}),s.jsx("ul",{className:"max-h-96 overflow-y-auto",children:o.map(e=>s.jsx("li",{className:`cursor-pointer p-2 text-sm hover:bg-muted/50 ${r?.id===e.id?"bg-muted":""}`,onClick:()=>S(e.id),children:e.name},e.id))})]}),s.jsx("div",{className:"md:col-span-2",children:r?s.jsxs("div",{children:[s.jsxs("h3",{className:"mb-4 text-lg font-medium",children:[r.name," のロール"]}),s.jsx("div",{className:"space-y-3",children:g.map(e=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(A,{id:`role-${e.id}`,checked:!!i[e.id],onCheckedChange:()=>l(t=>({...t,[e.id]:!t[e.id]}))}),s.jsx(B,{htmlFor:`role-${e.id}`,className:"font-normal",children:e.name})]},e.id))}),s.jsx("div",{className:"mt-6 flex justify-end",children:C&&s.jsx(R,{onClick:k,disabled:m,children:m?"保存中...":"保存"})})]}):s.jsx("div",{className:"flex h-full min-h-48 items-center justify-center text-muted-foreground",children:"左のリストからユーザーを選択してください"})})]})})]}),d&&s.jsx(H,{message:d.message,type:d.type,onClose:()=>p(null)})]})]})}export{W as default};
