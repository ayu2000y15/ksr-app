import{r as i,u as S,a as x,j as e,H as _,L as I,b as L}from"./app-fAu9F8Qa.js";import{H as R}from"./heading-NX2FQOTU.js";import{c as N,B as u}from"./app-logo-icon-BgJucqo0.js";import{C as $,a as z,b as A,c as E}from"./card-Cgnbhpij.js";import{P as B,T as O,a as q,b as w,c as t,d as G,e as c,f as M}from"./table-CMzM7W9g.js";import{T as V}from"./toast-NxCvUzdU.js";import{A as F}from"./app-sidebar-layout-DOACWoPa.js";/* empty css            */import"./index-CXCml9p6.js";import"./index-46EnhBWJ.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],K=N("GripVertical",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],U=N("SquarePen",Q),W=[{title:"各種設定",href:"#"},{title:"ロール管理",href:route("admin.roles")}];function le(){const[h,p]=i.useState([]),[n,f]=i.useState(null),[o,j]=i.useState(null),T=S().props?.auth?.permissions??[],l=s=>T.includes(s);i.useEffect(()=>{g()},[]);const g=async()=>{const s=await x.get("/api/roles");p(s.data)},k=async s=>{try{await x.post("/api/roles/reorder",{order:s.map(a=>a.id)}),j({message:"並び順を保存しました",type:"success"})}catch{}},v=(s,a)=>{f(a),s.dataTransfer.effectAllowed="move"},C=(s,a)=>{s.preventDefault(),!(n===null||n===a)&&p(r=>{const y=r.findIndex(m=>m.id===n),b=r.findIndex(m=>m.id===a);if(y===-1||b===-1)return r;const d=[...r],[H]=d.splice(y,1);return d.splice(b,0,H),d})},P=async()=>{f(null),await k(h)},D=async s=>{window.confirm(`ロール「${s.name}」を削除しますか？`)&&(await x.delete(`/api/roles/${s.id}`),g())};return e.jsxs(F,{breadcrumbs:W,children:[e.jsx(_,{title:"ロール管理"}),e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[e.jsx("div",{className:"mb-6",children:e.jsx(R,{title:"ロール管理",description:"ユーザーの役割（管理者、一般など）を定義する。"})}),e.jsxs($,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between",children:[e.jsx(A,{children:"ロール一覧"}),l("role.create")&&e.jsx(I,{href:route("admin.roles")+"/create",children:e.jsxs(u,{children:[e.jsx(B,{className:"mr-0 h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"新規ロール"})]})})]}),e.jsxs(E,{children:[e.jsxs(O,{children:[e.jsx(q,{children:e.jsxs(w,{children:[e.jsx(t,{className:"w-8"}),e.jsx(t,{children:"並び順"}),e.jsx(t,{children:"名前"}),e.jsx(t,{children:"説明"}),e.jsx(t,{className:"text-right",children:"操作"})]})}),e.jsx(G,{children:h.map((s,a)=>e.jsxs(w,{draggable:!0,onDragStart:r=>v(r,s.id),onDragOver:r=>C(r,s.id),onDragEnd:P,className:`cursor-grab ${n===s.id?"opacity-60":""}`,children:[e.jsx(c,{className:"w-8",children:e.jsx(K,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(c,{className:"w-12",children:typeof s.order_column<"u"?s.order_column+1:a+1}),e.jsx(c,{children:s.name}),e.jsx(c,{children:s.description}),e.jsxs(c,{className:"text-right",children:[l("role.update")&&e.jsxs(u,{variant:"outline",size:"sm",className:"mr-2",onClick:()=>L.get(route("admin.roles")+`/${s.id}/edit`),children:[e.jsx(U,{className:"mr-2 h-4 w-4"})," 編集"]}),l("role.delete")&&e.jsxs(u,{variant:"destructive",size:"sm",onClick:()=>D(s),children:[e.jsx(M,{className:"mr-2 h-4 w-4"})," 削除"]})]})]},s.id))})]}),o&&e.jsx(V,{message:o.message,type:o.type,onClose:()=>j(null)})]})]})]})]})}export{le as default};
