import{r as a,a as c,u as k,j as s,H as P}from"./app-DKRyNxm0.js";import{T as R}from"./toast-DqCeM660.js";import{H as w}from"./heading-BX_Jp4Kc.js";import{B as H}from"./app-logo-icon-CehQoGfx.js";import{C as E,a as T,b as $,c as L}from"./card-CXCGl3qJ.js";import{C as A}from"./checkbox-B0wH8ygF.js";import{L as B}from"./label-CVrHGdFQ.js";import{A as _}from"./app-sidebar-layout-Duv2q2dp.js";/* empty css            */import"./index-C5wNPedj.js";import"./index-C0UCeXqT.js";const F=[{title:"各種設定",href:"#"},{title:"ロールへの権限割り当て",href:route("admin.role-permissions")}];function X(){const[d,f]=a.useState([]),[j,g]=a.useState([]),[i,b]=a.useState(null),[o,l]=a.useState({}),[m,p]=a.useState(!1),[r,u]=a.useState(null);a.useEffect(()=>{h(),N()},[]);const h=async()=>{const e=await c.get("/api/roles");f(e.data)},N=async()=>{const e=await c.get("/api/permissions");g(e.data)},v=e=>{const t=d.find(n=>n.id===e)||null;b(t);const x={};(t?.permissions||[]).forEach(n=>{x[n.id]=!0}),l(x)},C=async()=>{if(!i)return;p(!0);const e=Object.keys(o).filter(t=>o[Number(t)]).map(Number);await c.post(`/api/roles/${i.id}/permissions`,{permission_ids:e}),await h(),p(!1),u({message:"保存しました",type:"success"})},y=k().props?.auth?.permissions??[],S=e=>y.includes(e);return s.jsxs(_,{breadcrumbs:F,children:[s.jsx(P,{title:"ロールへの権限割り当て"}),s.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[s.jsx("div",{className:"mb-6",children:s.jsx(w,{title:"ロールへの権限割り当て",description:"各役割（ロール）にどの操作を許可（権限）するかを設定する。"})}),s.jsxs(E,{children:[s.jsx(T,{children:s.jsx($,{children:"権限の関連付け"})}),s.jsx(L,{children:s.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[s.jsxs("div",{className:"rounded-md border",children:[s.jsx("div",{className:"border-b p-2 font-semibold",children:"ロール"}),s.jsx("ul",{className:"max-h-96 overflow-y-auto",children:d.map(e=>s.jsx("li",{className:`cursor-pointer p-2 text-sm hover:bg-muted/50 ${i?.id===e.id?"bg-muted":""}`,onClick:()=>v(e.id),children:e.name},e.id))})]}),s.jsx("div",{className:"md:col-span-2",children:i?s.jsxs("div",{children:[s.jsxs("h3",{className:"mb-4 text-lg font-medium",children:[i.name," の権限"]}),s.jsx("div",{className:"space-y-3",children:j.map(e=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(A,{id:`perm-${e.id}`,checked:!!o[e.id],onCheckedChange:()=>l(t=>({...t,[e.id]:!t[e.id]}))}),s.jsx(B,{htmlFor:`perm-${e.id}`,className:"font-normal",children:e.name})]},e.id))}),s.jsx("div",{className:"mt-6 flex justify-end",children:S("role.update")&&s.jsx(H,{onClick:C,disabled:m,children:m?"保存中...":"保存"})})]}):s.jsx("div",{className:"flex h-full min-h-48 items-center justify-center text-muted-foreground",children:"左のリストからロールを選択してください"})})]})})]}),r&&s.jsx(R,{message:r.message,type:r.type,onClose:()=>u(null)})]})]})}export{X as default};
